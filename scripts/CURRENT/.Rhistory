rm(list=ls())
# Load configuration information ------------------------------------------
configuration_info <- scan(file = "configuration",
what = "text")
start_date <- configuration_info[grep("start_date", configuration_info)]
start_date <- strsplit(start_date, split = ":")[[1]][2]
end_date <- configuration_info[grep("end_date", configuration_info)]
end_date <- strsplit(end_date, split = ":")[[1]][2]
path_to_save_raw_data <- configuration_info[grep("path_to_save_raw_data", configuration_info)]
path_to_save_raw_data <- strsplit(path_to_save_raw_data, split = ":")[[1]][2]
path_pyspark <- configuration_info[grep("path_pyspark", configuration_info)]
path_pyspark <- strsplit(path_pyspark, split = ":")[[1]][2]
path_to_save_summarized_data <- configuration_info[grep("path_to_save_summarized_data", configuration_info)]
path_to_save_summarized_data <- strsplit(path_to_save_summarized_data, split = ":")[[1]][2]
path_to_save_package_HTML <- configuration_info[grep("path_to_save_package_HTML", configuration_info)]
path_to_save_package_HTML <- strsplit(path_to_save_package_HTML, split = ":")[[1]][2]
path_to_save_map_JS_data <- configuration_info[grep("path_to_save_map_JS_data", configuration_info)]
path_to_save_map_JS_data <- strsplit(path_to_save_map_JS_data, split = ":")[[1]][2]
# Download the raw data ---------------------------------------------------
cat(rep("=", 18), "\n")
cat("Step-1: Downloading the raw data\n")
cat(rep("=", 18), "\n\n")
system(command = paste("Rscript 1_download_raw_data.R",
start_date,
end_date,
path_to_save_raw_data))
cat(rep("=", 18), "\n")
cat("Step-2: Summarizing raw data with Apache Spark\n")
cat(as.character(Sys.time()), "\n")
cat(rep("=", 18), "\n\n")
system(command = paste(path_pyspark,
"2_summarize_raw_data.py",
path_to_save_raw_data,
path_to_save_summarized_data,
start_date,
end_date))
cat("//")
cat("/")
